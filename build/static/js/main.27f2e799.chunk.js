(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{38:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r(1),a=r.n(s),o=r(23),c=r.n(o),i=r(4),l=r(9),d=r(2),u=r.n(d),p=r(3),m=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof window){e.next=7;break}return localStorage.removeItem("jwt"),t(),e.next=5,fetch("".concat("http://localhost:9092/tds","/signout"),{method:"GET"});case 5:return r=e.sent,e.abrupt("return",r.json({message:"User disconnected"}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e,t){"undefined"!==typeof window&&localStorage.setItem("jwt",JSON.stringify(e)),t()},f=function(){return"undefined"!==typeof window&&(!!localStorage.getItem("jwt")&&JSON.parse(localStorage.getItem("jwt")))},x=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("[front-end/auth/index.js => forgotPassword:67] : email: ".concat(t)),e.prev=1,e.next=4,fetch("".concat("http://localhost:9092/tds","/forgot-password/"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t})});case 4:return r=e.sent,console.log("[front-end/auth/index.js => forgotPassword:81] : response: ",r),e.abrupt("return",r.json());case 9:e.prev=9,e.t0=e.catch(1),console.error("[front-end/src/auth/index.js => forgotPassword:85] : error: ".concat(e.t0,"."));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/reset-password/"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0),console.error("[front-end/auth/index.js => resetPassword:101] : error: ".concat(e.t0,"."));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),v=function(e,t){return e.location.pathname===t?{color:"#3BA7BF",fontWeight:"bold"}:{color:"#0D0D0D"}},O=Object(l.g)((function(e){var t=e.history;return Object(n.jsx)("div",{className:"container",children:Object(n.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(n.jsxs)("ul",{className:"nav nav-tabs",children:[Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{className:"navbar-link mr-3",style:v(t,"/"),to:"/",children:"La Taverne"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{className:"navbar-link mr-3",style:v(t,"/users"),to:"/users",children:"Les Pirates de la Taverne"})}),!f()&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{className:"navbar-link mr-3",style:v(t,"/signin"),to:"/signin",children:"Connexion"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{className:"navbar-link mr-3",style:v(t,"/signup"),to:"/signup",children:"Rejoindre"})})]}),f()&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{to:"/posts",style:v(t,"/posts"),className:"navbar-link mr-3",children:"Messages"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{to:"/post/create",style:v(t,"/post/create"),className:"navbar-link mr-3",children:"Envoyer un message"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{className:"navbar-link mr-3",style:(v(t,"/user/".concat(f().user._id)),{color:"#81A65D",fontWeight:"bold"}),to:"/user/".concat(f().user._id),children:"Planque ".concat(/^[aeiou]/i.test(f().user.pseudo.toLowerCase())?"d'":"de ").concat(f().user.pseudo)})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{to:"/",onClick:function(){return b((function(){return t.push("/")}))},className:"navbar-link mr-5",style:(v(t,"/signout"),{color:"#8C0303",fontWeight:"bold"}),children:"D\xe9connexion"})}),f()&&"Roi des Pirates"===f().user.right&&Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(i.b,{to:"/admin",className:"navbar-link mr-5",style:(v(t,"/admin"),{color:"#9662E3",fontWeight:"bold"}),children:"Administration du Roi des Pirates"})})]})]})})})})),y=r(25),w=r(5),N=r(6),S=r(8),C=r(7),k=function(e){var t=e.pseudo,r=e.message;return Object(n.jsx)("div",{className:"container col col-md-12",children:Object(n.jsx)("div",{className:"container row row-12",children:Object(n.jsxs)("p",{className:"text-center",children:[Object(n.jsx)("strong",{children:t}),": ",Object(n.jsx)("em",{children:r})]})})})},P=r.p+"static/media/sot-wp.966d86a1.jpg",T=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={message:""},e}return Object(N.a)(r,[{key:"render",value:function(){var e=this;return f()?Object(n.jsx)("div",{className:"container jumbotron",style:{padding:"32px 32px"},children:Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col-md-12 mt-3 mb-3",children:Object(n.jsxs)("h4",{className:" text-center",style:{fontWeight:"bold"},children:["Bienvenue dans la Taverne, ",f().user.pseudo]})}),Object(n.jsx)("form",{action:"",onSubmit:function(t){t.preventDefault(),e.props.onSubmitMessage(e.state.message),e.setState({message:""})},className:"form-control jumbotron text-center",style:{padding:"32px 32px"},children:Object(n.jsx)("div",{className:"container row d-flex flex-row",children:Object(n.jsxs)("div",{className:"col text-center",children:[Object(n.jsx)("input",{type:"text",placeholder:"Ecris ici ce que tu as \xe0 dire, ".concat(f().user.pseudo,"..."),value:this.state.message,style:{width:"444px",height:"42px"},onChange:function(t){return e.setState({message:t.target.value})}}),Object(n.jsx)("button",{className:"btn btn-primary font-weight-bold lead btn-lg",type:"submit",style:{boxShadow:"2px 2px 3px grey",color:"#81A65D"},children:"Envoyer"})]})})})]})}):Object(n.jsx)("div",{className:"container jumbotron",style:{padding:"0px 32px"},children:Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12 mt-5 mb-5",children:[Object(n.jsx)("h4",{className:" text-center",style:{fontWeight:"bold"},children:"Bienvenue dans la Taverne, pirate !"}),Object(n.jsx)("img",{src:"".concat(P),alt:"wall-paper-sea-of-thieves",style:{width:"100%",height:"100%",maxWidth:"auto",maxHeight:"auto",boxShadow:"3px 3px 10px grey"}})]})})})}}]),r}(s.Component),D="ws://localhost:9092",I=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={pseudo:"",messages:[]},e.socket=new WebSocket(D),e.addMessage=function(t){return e.setState((function(e){return{messages:[t].concat(Object(y.a)(e.messages))}}))},e.submitMessage=function(t){var r={pseudo:e.state.pseudo,message:t};e.socket.send(JSON.stringify(r)),e.addMessage(r)},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.socket.onopen=function(t){if(f()){var r=f().user.pseudo;e.setState({pseudo:r})}else e.setState({pseudo:"Pirate inconnu"})},this.socket.onmessage=function(t){var r=JSON.parse(t.data);e.addMessage(r)},this.socket.onclose=function(){e.setState({socket:new WebSocket(D)})}}},{key:"render",value:function(){var e=this,t=this.state.messages;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)(T,{socket:this.socket,onSubmitMessage:function(t){return e.submitMessage(t)}}),t.map((function(e,t){return Object(n.jsx)(k,{message:e.message,pseudo:e.pseudo},t)}))]})}}]),r}(s.Component),R=function(){var e=Object(p.a)(u.a.mark((function e(t,r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/user/").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/users/?page=").concat(t),{method:"GET"});case 3:return r=e.sent,e.abrupt("return",r.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(u.a.mark((function e(t,r,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/user/").concat(t),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(r)},body:n});case 3:return s=e.sent,e.abrupt("return",s.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't put data to api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),M=function(e,t){if("undefined"!==typeof window&&localStorage.getItem("jwt")){var r=JSON.parse(localStorage.getItem("jwt"));r.user=e,localStorage.setItem("jwt",JSON.stringify(r)),t()}},F=function(){var e=Object(p.a)(u.a.mark((function e(t,r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/user/").concat(t),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),_=r.p+"static/media/default-image.2f816011.png",z=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={users:[],page:1},e.loadUsers=function(){var t=Object(p.a)(u.a.mark((function t(r){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A(r);case 3:(n=t.sent)?e.setState({users:n}):console.error("No users were retrieved from the server because of error."),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Couldn't list all users because of error: ".concat(t.t0,"."));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e.getMoreUsers=function(t){e.setState({page:e.state.page+1}),e.loadUsers(e.state.page+t)},e.getLessUsers=function(t){e.setState({page:e.state.page-1}),e.loadUsers(e.state.page-t)},e.componentDidMount=Object(p.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.loadUsers(e.state.page);case 1:case"end":return t.stop()}}),t)}))),e.renderUsers=function(e){return Object(n.jsx)("div",{className:"row",style:{justifyContent:"center",position:"relative"},children:e.map((function(e,t){var r=e.photo,s=e._id,a=e.pseudo,o=e.about;return r?Object(n.jsxs)("div",{className:"card card-block col-sm-12 col-md-6 col-lg-4 col-xl-3",style:{backgroundColor:"#D9D9D9",marginRight:"30px",marginBottom:"30px",boxShadow:"3px 3px 5px grey",borderRadius:"3%"},children:[Object(n.jsx)("div",{className:"card-body text-center",children:Object(n.jsx)("img",{style:{height:"auto",width:"auto",marginTop:"15px",borderRadius:"25%",boxShadow:"3px 3px 10px grey"},src:"".concat("http://localhost:9092/tds","/user/photo/").concat(s),onError:function(e){return e.target.src="".concat(_)},className:"img-thumbnail mb-3",alt:a})},t),Object(n.jsx)("hr",{}),Object(n.jsx)("h5",{className:"card-title text-center font-weight-bold mb-3",children:a}),Object(n.jsx)("p",{className:"card-text text-justify mb-5",children:o}),Object(n.jsx)(i.b,{to:"/user/".concat(s),className:"btn btn-lg btn-block btn-outline-success text-center font-weight-bold mb-3",children:"Planque"})]},t):Object(n.jsxs)("div",{className:"card card-block col-sm-12 col-md-6 col-lg-4 col-xl-3",style:{backgroundColor:"#D5E5F2",marginRight:"30px",marginBottom:"30px"},children:[Object(n.jsx)("img",{style:{height:"auto",width:"auto",marginTop:"15px",borderRadius:"50%"},src:"".concat(_),onError:function(e){return e.target.src="".concat(_)},className:"img-thumbnail mb-3",alt:a}),Object(n.jsxs)("div",{className:"card-body d-flex flex-column",children:[Object(n.jsx)("h5",{className:"card-title text-center",children:a}),Object(n.jsx)("p",{className:"card-text mb-5",children:o}),Object(n.jsx)(i.b,{to:"/user/".concat(s),className:"btn btn-lg btn-block btn-outline-success text-center font-weight-bold mb-3",children:"Planque"})]},t)]},t)}))})},e}return Object(N.a)(r,[{key:"render",value:function(){var e=this,t=this.state,r=t.users,s=t.page;return Object(n.jsxs)("div",{className:"jumbotron",children:[Object(n.jsx)("h2",{className:"mt-3 mb-5 text-center",style:{fontWeight:"bold"},children:r.length?"Les Pirates de la Taverne des Soiffards":"Rien \xe0 afficher pour le moment..."}),this.renderUsers(r),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col text-right",children:s>1?Object(n.jsx)("button",{className:"btn btn-raised btn-info mt-5 mb-5",onClick:function(){return e.getLessUsers(1)},style:{boxShadow:"3px 3px 5px grey"},children:"Page pr\xe9c\xe9dente"}):""}),Object(n.jsx)("div",{className:"col text-left",children:r.length>s&&r.length===Number("6")?Object(n.jsx)("button",{className:"btn btn-raised btn-info mt-5 mb-5",onClick:function(){return e.getMoreUsers(1)},style:{boxShadow:"3px 3px 5px grey"},children:"Page suivante"}):""})]})]})}}]),r}(s.Component),L=r(11),W=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={pseudo:"",email:"",password:"",error:"",success:!1},e.handleChange=function(t){return function(r){e.setState({error:""}),e.setState(Object(L.a)({},t,r.target.value))}},e.signupForm=function(t,r,s){return Object(n.jsxs)("form",{action:"",children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"Name",className:"text-muted lead",style:{fontWeight:"bold"},children:"Pseudo"}),Object(n.jsx)("input",{onChange:e.handleChange("pseudo"),type:"text",className:"form-control",value:t,placeholder:"Le nom qui sera visible par les autres utilisateurs de la Taverne",required:!0})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"Email",className:"text-muted lead",style:{fontWeight:"bold"},children:"E-mail"}),Object(n.jsx)("input",{onChange:e.handleChange("email"),type:"email",className:"form-control",value:r,placeholder:"Votre e-mail de contact (example : guy-tard@gmail.com)",required:!0}),Object(n.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:Object(n.jsx)("em",{children:"Votre e-mail est strictement confidentiel et ne sera partag\xe9 avec aucune tierce partie"})})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"Password",className:"text-muted lead",style:{fontWeight:"bold"},children:"Mot de passe"}),Object(n.jsx)("input",{onChange:e.handleChange("password"),type:"password",className:"form-control",value:s,placeholder:"Ne communiquez jamais votre mot de passe \xe0 qui que ce soit.",required:!0})]}),Object(n.jsx)("button",{onClick:e.signupSubmit,type:"submit",className:"btn btn-raised btn-primary",children:"S'inscrire"})]})},e.signupSubmit=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a,o,c,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),n=e.state,s=n.pseudo,a=n.email,o=n.password,c={pseudo:s,email:a,password:o},t.prev=3,t.next=6,m(c);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error("Couldn't get a response, type of response is ".concat(typeof i,"."));case 12:if(i.error)try{e.setState({error:i.error})}catch(l){console.error("Couldn't change state because of error: ".concat(l,"."))}else try{e.setState({pseudo:"",email:"",password:"",error:"",success:!0})}catch(l){console.error("Couldn't change state because of error: ".concat(l,"."))}case 13:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(N.a)(r,[{key:"render",value:function(){var e=this.state,t=e.pseudo,r=e.email,s=e.password,a=e.error,o=e.success;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h2",{className:"mt-5 mb-5 text-center",children:"Inscription"}),Object(n.jsx)("div",{className:"alert alert-warning",style:{display:a?"":"none"},children:a}),Object(n.jsxs)("div",{className:"alert alert-success",style:{display:o?"":"none"},children:["Ton compte vient d'\xeatre cr\xe9\xe9, pirate ! A la ",Object(n.jsx)(i.b,{to:"/signin",children:"Taverne"}),", maintenant !"]}),this.signupForm(t,r,s)]})}}]),r}(s.Component),q=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:"",error:"",loading:!1,redirection:!1},e.signinForm=function(t,r){return Object(n.jsxs)("form",{action:"",children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"Email",className:"text-muted lead",style:{fontWeight:"bold"},children:"E-mail"}),Object(n.jsx)("input",{onChange:e.handleChange("email"),type:"email",name:"email",className:"form-control",value:t,autoFocus:!0,required:!0})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"Password",className:"text-muted lead",style:{fontWeight:"bold"},children:"Mot de passe"}),Object(n.jsx)("input",{onChange:e.handleChange("password"),type:"password",name:"password",className:"form-control",value:r,required:!0})]}),Object(n.jsx)("button",{onClick:e.signinSubmit,type:"submit",className:"btn btn-raised btn-primary",children:"Entrer dans la Taverne"})]})},e.handleChange=function(t){return function(r){e.setState({error:""}),e.setState(Object(L.a)({},t,r.target.value))}},e.signinSubmit=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a,o,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e.setState({loading:!0}),n=e.state,s=n.email,a=n.password,o={email:s,password:a},""===s||""===a){t.next=17;break}return t.prev=5,t.next=8,h(o);case 8:c=t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),console.error("Couldn't retrieve data using signin method.");case 14:c.error?e.setState({loading:!1,error:c.error}):j(c,(function(){e.setState({redirection:!0})})),t.next=18;break;case 17:e.setState({loading:!1,error:"Tu dois renseigner un e-mail et un mot de passe, sacrebleu !"});case 18:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(N.a)(r,[{key:"render",value:function(){var e=this.state,t=e.email,r=e.password,s=e.error,a=e.redirection,o=e.loading;return a?Object(n.jsx)(l.a,{to:"/"}):Object(n.jsx)("div",{className:"container",children:o?Object(n.jsx)("div",{className:"jumbotron",style:{margin:"0",padding:"0",display:"flex",justifyContent:"center",alignItems:"center",height:"100vw",width:"100vw"},children:Object(n.jsx)("h3",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:"Chargement..."})}):Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h2",{className:"mt-5 mb-2 text-center",children:"Bienvenue, moussaillon !"}),Object(n.jsx)("p",{className:"lead mb-5 text-center",children:"Connecte-toi pour acc\xe9der aux fonctionnalit\xe9s du site !"}),Object(n.jsx)("div",{className:"alert alert-warning",style:{display:s?"":"none"},children:s}),this.signinForm(t,r),Object(n.jsx)("button",{className:"btn btn-raised btn-danger btn-sm",children:Object(n.jsx)(i.b,{to:"/forgot-password",className:"text",style:{color:"#ffffff"},children:"Mot de passe oubli\xe9"})})]})})}}]),r}(s.Component),B=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={redirectionSignIn:!1,allMighty:!1},e.deleteAccount=Object(p.a)(u.a.mark((function t(){var r,n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f().token,n=e.props.userId,t.prev=2,t.next=5,F(n,r);case 5:(s=t.sent).error?console.error("An error occured during account deletion: ".concat(s.error,".")):"Roi des Pirates"===!f().user.right&&(b((function(){console.log("User has been deleted.")})),e.setState({redirectionSignIn:!0})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("Couldn't get a response from server because of error: ".concat(t.t0,"."));case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),e.deleteConfirmation=function(){var t,r;"Roi des Pirates"===f().user.right?r=window.confirm("Tu vas supprimer le profil de ce Pirate de fa\xe7on irr\xe9versible ; m\xeame toi tu n'y pourras plus rien, mon Roi.\n        Es-tu bien certain que c'est ce que tu veux faire ?"):t=window.confirm("Tu vas supprimer ton profil de fa\xe7on TOTALEMENT d\xe9finitive, moussaillon, tu es s\xfbr ?\n         M\xeame le Roi des Pirates n'y pourra plus rien, j'te pr\xe9viens..."),(t||r)&&e.deleteAccount()},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){"Roi des Pirates"===f().user.right&&this.setState({allMighty:!0})}},{key:"render",value:function(){var e=this.state,t=e.redirectionSignIn,r=e.allMighty,s=this.props.userId;return t?Object(n.jsx)(l.a,{to:"/signin"}):r&&f().user._id!==s?Object(n.jsx)("button",{onClick:this.deleteConfirmation,className:"btn btn-raised btn-dark font-weight-bold",children:"Supprimer en tant que Roi"}):Object(n.jsx)("button",{onClick:this.deleteConfirmation,className:"btn btn-raised btn-danger",children:"Quitter d\xe9finitivement la Taverne"})}}]),r}(s.Component),U=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){return Object(w.a)(this,r),t.apply(this,arguments)}return Object(N.a)(r,[{key:"render",value:function(){var e=this.props.posts;return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"col-md-12",children:[Object(n.jsxs)("h3",{className:"text-primary",children:[e.length," Posts"]}),Object(n.jsx)("hr",{}),e.map((function(e,t){return Object(n.jsx)("div",{children:Object(n.jsx)("div",{children:Object(n.jsx)(i.b,{to:"/post/".concat(e._id),children:Object(n.jsx)("div",{children:Object(n.jsx)("p",{className:"lead",style:{color:"#81A65D"},children:e.title})})})})},t)}))]})})}}]),r}(s.Component),J=function(){var e=Object(p.a)(u.a.mark((function e(t,r,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/post/new/").concat(t),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(r)},body:n});case 3:return s=e.sent,e.abrupt("return",s.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't post data to api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/posts/?page=").concat(t),{method:"GET"});case 3:return r=e.sent,e.abrupt("return",r.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(p.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/post/").concat(t),{method:"GET"});case 3:return r=e.sent,e.abrupt("return",r.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api in viewPost because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(p.a)(u.a.mark((function e(t,r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/posts/by/").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),Z=function(){var e=Object(p.a)(u.a.mark((function e(t,r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/post/").concat(t),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't get response from api because of error: ".concat(e.t0,".")));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),$=function(){var e=Object(p.a)(u.a.mark((function e(t,r,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/post/").concat(t),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(r)},body:n});case 3:return s=e.sent,console.info("INSIDE UPDATEPOST APRES LE FETCH MAIS AVANT LE RETOUR DE LA REPONSE"),e.abrupt("return",s.json());case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",console.error("Couldn't put data to api because of error: ".concat(e.t0,".")));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(p.a)(u.a.mark((function e(t,r,n,s){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:9092/tds","/post/comment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({userId:t,postId:n,comment:s})});case 3:return a=e.sent,e.abrupt("return",a.json());case 7:e.prev=7,e.t0=e.catch(0),console.error("[front-end/src/logic/post/apiPosts.js => writeComment] : error: ".concat(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n,s){return e.apply(this,arguments)}}(),K=function(){var e=Object(p.a)(u.a.mark((function e(t,r,n,s){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("[front-end/src/logic/post/apiPost.js => deleteComment] : userId: ".concat(t,", token: ").concat(r,", postId: ").concat(n)),e.next=4,fetch("".concat("http://localhost:9092/tds","/post/uncomment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({userId:t,postId:n,comment:s})});case 4:return a=e.sent,e.abrupt("return",a.json());case 8:e.prev=8,e.t0=e.catch(0),console.error("[front-end/src/logic/post/apiPosts.js => deleteComment] : error: ".concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r,n,s){return e.apply(this,arguments)}}(),X=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={user:"",redirectionSignIn:!1,posts:[]},e.init=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=f().token,t.next=4,R(r,n);case 4:(s=t.sent).error?(console.error("[front-end/src/user/Profile.jsx => init:28] : data.error: ".concat(s.error)),e.setState={redirectionSignIn:!0}):(e.setState({user:s}),e.loadPosts(s._id)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("[front-end/src/user/Profile.jsx => init:40] : error: ".concat(t.t0,"."));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.loadPosts=function(t){var r=f().token;G(t,r).then((function(t){t.error?console.log(t.error):e.setState({posts:t})}))},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){try{var e=this.props.match.params.userId;e?this.init(e):console.error("No userId found.")}catch(t){console.error("Something went wrong with componentDidMount method.")}}},{key:"componentWillReceiveProps",value:function(e){try{var t=e.match.params.userId;t?this.init(t):console.error("No userId found.")}catch(r){console.error("Something went wrong with componentWillReceiveProps method.")}}},{key:"render",value:function(){var e=this.state,t=e.redirectionSignIn,r=e.user,s=e.posts,a=r._id,o=r.pseudo,c=r.email,d=r.photo,u=r.about,p=r.created,m=r.role,h=r.hobbies;if(t)return Object(n.jsx)(l.a,{to:"/signin"});if(d){var b=a?"".concat("http://localhost:9092/tds","/user/photo/").concat(a,"?").concat((new Date).getTime()):_;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h3",{className:"mb-5",children:o}),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col-md-4",children:Object(n.jsx)("img",{style:{height:"300px",width:"auto",borderRadius:"25%",boxShadow:"3px 3px 10px grey"},className:"img-thumbnail",src:b,onError:function(e){return e.target.src="".concat(_)},alt:o})}),Object(n.jsxs)("div",{className:"col-md-8",children:[Object(n.jsxs)("div",{className:"lead mt-2",children:[Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Inscription :\xa0"}),Object(n.jsx)("p",{children:" ".concat(new Date(p).toLocaleDateString("fr-FR"))})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Email :\xa0"}),Object(n.jsx)("p",{children:c})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"R\xf4le favori :\xa0"}),Object(n.jsx)("p",{children:m})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Loisirs :\xa0"}),Object(n.jsx)("p",{children:h})]})]}),f().user&&f().user._id===a&&Object(n.jsxs)("div",{className:"d-inline-block",children:[Object(n.jsx)(i.b,{to:"/post/create",className:"btn btn-raised btn-info mr-5 mb-3",children:"Poster un message"}),Object(n.jsx)(i.b,{to:"/user/edit/".concat(a),className:"btn btn-raised btn-success mr-5 mb-3",children:"Modifier les informations"}),Object(n.jsx)(B,{userId:a})]}),Object(n.jsx)("div",{children:f().user&&"Roi des Pirates"===f().user.right&&Object(n.jsx)("div",{className:"card mt-5 jumbotron",style:{boxShadow:"3px 3px 10px grey",borderRadius:"10%",backgroundColor:"#D9D9D9",padding:"32px"},children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsx)("h5",{className:"card-title mb-3",style:{color:"#9662E3",fontWeight:"bold"},children:"Interface du Roi des Pirates"}),Object(n.jsx)(i.b,{className:"btn btn-raised btn-light mr-5 font-weight-bold",to:"/user/edit/".concat(a),style:{color:"black"},children:"Modifier en tant que Roi"}),Object(n.jsx)(B,{userId:a})]})})})]})]}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12 mt-5",children:[Object(n.jsx)("hr",{}),Object(n.jsx)("p",{className:"lead",style:{fontWeight:"bold"},children:"A propos de moi :\xa0"}),Object(n.jsx)("p",{className:"lead",children:u}),Object(n.jsx)("hr",{}),Object(n.jsx)(U,{posts:s})]})})]})}return Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("h3",{className:"mb-5 mt-5",children:o}),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col-md-4",children:Object(n.jsx)("img",{style:{height:"300px",width:"auto",borderRadius:"25%"},className:"img-thumbnail",src:"".concat(_),onError:function(e){return e.target.src="".concat(_)},alt:o})}),Object(n.jsxs)("div",{className:"col-md-8",children:[Object(n.jsxs)("div",{className:"lead mt-2",children:[Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Inscription :\xa0"}),Object(n.jsx)("p",{children:" ".concat(new Date(p).toLocaleDateString("fr-FR"))})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Email :\xa0"}),Object(n.jsx)("p",{children:c})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"R\xf4le favori :\xa0"}),Object(n.jsx)("p",{children:m})]}),Object(n.jsxs)("div",{className:"container row",children:[Object(n.jsx)("p",{style:{fontWeight:"bold"},children:"Loisirs :\xa0"}),Object(n.jsx)("p",{children:h})]})]}),f().user&&f().user._id===a&&Object(n.jsxs)("div",{className:"d-inline-block",children:[Object(n.jsx)(i.b,{to:"/post/create",className:"btn btn-raised btn-info mr-5 mb-3",children:"Poster un message"}),Object(n.jsx)(i.b,{to:"/user/edit/".concat(a),className:"btn btn-raised btn-success mr-5 mb-3",children:"Modifier les informations"}),Object(n.jsx)(B,{userId:a})]})]})]}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12 mt-5",children:[Object(n.jsx)("hr",{}),Object(n.jsx)("p",{className:"lead",children:u}),Object(n.jsx)("hr",{}),Object(n.jsx)(U,{posts:s})]})})]})}}]),r}(s.Component),Y=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={id:"",pseudo:"",email:"",password:"",about:"",role:"",hobbies:"",redirectionProfile:!1,error:"",fileSize:0,loading:!1},e.init=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=f().token,t.next=4,R(r,n);case 4:(s=t.sent).error?e.setState={redirectionProfile:!0}:e.setState({id:s._id,pseudo:s.pseudo,email:s.email,about:s.about,role:s.role,hobbies:s.hobbies,error:""}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("The init method encountered the following error: ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){return function(r){var n;e.setState({error:""});var s="photo"===t?r.target.files[0]:r.target.value,a="photo"===t?r.target.files[0].size:0;e.userData.set(t,s),e.setState((n={},Object(L.a)(n,t,s),Object(L.a)(n,"fileSize",a),n))}},e.isValid=function(){var t=e.state,r=t.pseudo,n=t.email,s=t.password,a=t.fileSize,o=t.about,c=t.hobbies,i=t.role;return 0===r.length&&0===n.length&&0===s.length&&0===o.length&&0===c.length&&0===i.length?(e.setState({loading:!1,error:"Il n'y a rien \xe0 changer, l\xe0, moussaillon !"}),!1):a>1e6?(e.setState({loading:!1,error:"Le poids du fichier ne doit pas d\xe9passer 1Mb ! D\xe9conne pas !"}),!1):r.length>=1&&(r.length<4||r.length>30)?(e.setState({loading:!1,error:"Ton pseudo doit faire entre 4 et 30 caract\xe8res, marin d'eau douce !"}),!1):s.length>=1&&!/^(?=(?:[^A-Z]*[A-Z]){1,}(?![^A-Z]*[A-Z]))(?=(?:[^a-z]*[a-z]){1,}(?![^a-z]*[a-z]))(?=(?:[^0-9]*[0-9]){1,}(?![^0-9]*[0-9]))(?=(?:[^!'#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]*[!'#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]){1,}(?![^!'#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]*[!'#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~])).{8,}$/.test(s)?(e.setState({loading:!1,error:"Ton mot de passe doit contenir au moins 8 caract\xe8res dont une lettre minuscule, une lettre majuscule, un chiffre et un caract\xe8re sp\xe9cial."}),!1):n.length>=1&&!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)?(e.setState({loading:!1,error:"Tu dois renseigner une adresse de courrier \xe9lectronique valide, moussailon !"}),!1):o.length>300?(e.setState({loading:!1,error:"Tu te pr\xe9sentes, moussaillon, tu ne r\xe9diges pas ta biographie ! Pas plus de 300 caract\xe8res !"}),!1):c.length>300?(e.setState({loading:!1,error:"Juste tes hobbies, moussaillon, pas ta vie enti\xe8re ! Pas plus de 300 caract\xe8res !"}),!1):!(i.length>50)||(e.setState({loading:!1,error:"Ton r\xf4le, moussaillon, sois concis et pr\xe9cis ! Pas plus de 50 caract\xe8res !"}),!1)},e.updateSubmit=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e.setState({loading:!0}),!e.isValid()){t.next=9;break}return n=e.props.match.params.userId,s=f().token,t.next=7,E(n,s,e.userData);case 7:(a=t.sent).error?e.setState({error:a.error}):"Roi des Pirates"===f().user.right?e.setState({redirectionProfile:!0}):M(a,(function(){e.setState({redirectionProfile:!0})}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateForm=function(t,r,s,a,o,c){return Object(n.jsxs)("form",{action:"",children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Photo de profil (ou de face...)"}),Object(n.jsx)("input",{onChange:e.handleChange("photo"),type:"file",name:"photo",accept:"image/*",className:"form-control"}),Object(n.jsx)("small",{id:"pictureHelp",className:"form-text text-muted",children:"S\xe9lectionnez de pr\xe9f\xe9rence une photo carr\xe9e (exemple : 400px * 400px)"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Pseudo"}),Object(n.jsx)("input",{onChange:e.handleChange("pseudo"),type:"text",name:"pseudo",className:"form-control",value:t,placeholder:"Laisser vide pour conserver le pseudo actuel.",autoFocus:!0})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"E-mail"}),Object(n.jsx)("input",{onChange:e.handleChange("email"),type:"email",name:"email",className:"form-control",value:r,placeholder:"Laisser vide pour conserver l'e-mail actuel."}),Object(n.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Votre e-mail ne sera partag\xe9 avec aucune tierse partie"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Mot de passe"}),Object(n.jsx)("input",{onChange:e.handleChange("password"),type:"password",name:"password",className:"form-control",value:s,placeholder:"Laisser vide pour conserver le mot de passe actuel."})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Bio"}),Object(n.jsx)("textarea",{onChange:e.handleChange("about"),type:"text",name:"about",className:"form-control",value:a,placeholder:"Raconte-nous ton histoire, flibustier ! Ou raconte des conneries, c'est toi qui vois..."})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"R\xf4le favori"}),Object(n.jsx)("textarea",{onChange:e.handleChange("role"),type:"text",name:"role",className:"form-control",value:o,placeholder:"Quel r\xf4le pr\xe9f\xe8res-tu assurer, moussaillon ? Les canons ou la chair \xe0 canon ?"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Loisirs"}),Object(n.jsx)("textarea",{onChange:e.handleChange("hobbies"),type:"text",name:"hobbies",className:"form-control",value:c,placeholder:"As-tu d'autres hobbies \xe0 part voler, piller et boire du rhum, pirate ?"})]}),Object(n.jsx)("button",{onClick:e.updateSubmit,type:"submit",className:"btn btn-raised btn-primary",children:"Modifier"})]})},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){this.userData=new FormData;try{var e=this.props.match.params.userId;e?this.init(e):console.error("No userId found.")}catch(t){console.error("Something went wrong with componentDidMount method.")}}},{key:"render",value:function(){var e=this.state,t=e.id,r=e.pseudo,s=e.email,a=e.password,o=e.about,c=e.role,i=e.hobbies,d=e.redirectionProfile,u=e.error,p=e.loading;if(d)return Object(n.jsx)(l.a,{to:"/user/".concat(t)});var m=t?"".concat("http://localhost:9092/tds","/user/photo/").concat(t,"?").concat((new Date).getTime()):"".concat(_);return Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("h2",{className:"mt-5 mb-5",children:"Modifier les informations du compte"}),Object(n.jsx)("div",{className:"alert alert-danger",style:{display:u?"":"none"},children:u}),p?Object(n.jsx)("div",{className:"jumbotron text-center",children:Object(n.jsx)("h3",{children:"Chargement..."})}):"",Object(n.jsx)("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:m,onError:function(e){return e.target.src="".concat(_)},alt:r}),("Roi des Pirates"===f().user.right||f().user._id===t)&&this.updateForm(r,s,a,o,c,i)]})}}]),r}(s.Component),ee=r.p+"static/media/beautiful-sea.b2ff0d6e.jpg",te=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={posts:[],page:1},e.loadPosts=function(){var t=Object(p.a)(u.a.mark((function t(r){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,V(r);case 3:(n=t.sent)?e.setState({posts:n}):console.error("No posts were retrieved from the server because of error."),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Couldn't change state of posts because of error: ".concat(t.t0,"."));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e.showMorePosts=function(t){e.setState({page:e.state.page+1}),e.loadPosts(e.state.page+t)},e.showLessPosts=function(t){e.setState({page:e.state.page-1}),e.loadPosts(e.state.page-t)},e.renderPosts=function(e){return Object(n.jsx)("div",{className:"row",style:{justifyContent:"center"},children:e.map((function(e,t){var r=e.author?"/user/".concat(e.author._id):"/posts",s=e.author?e.author.pseudo:"un Inconnu";return Object(n.jsxs)("div",{className:"card card-block col-sm-12 col-md-6 col-lg-4 col-xl-3",style:{backgroundColor:"#D9D9D9",marginRight:"30px",marginBottom:"30px",boxShadow:"3px 3px 5px grey",width:"300px",borderRadius:"3%"},children:[Object(n.jsx)("div",{className:"card-body text-center",children:Object(n.jsx)("img",{className:"img-thumbnail mb-3",style:{height:"auto",width:"auto",boxShadow:"3px 3px 10px grey"},src:"".concat("http://localhost:9092/tds","/post/photo/").concat(e._id),alt:e.title,onError:function(e){return e.target.src="".concat(ee)}})},t),Object(n.jsx)("hr",{}),Object(n.jsx)("h5",{className:"card-title text-center font-weight-bold mb-3",children:e.title}),Object(n.jsx)("p",{className:"card-text text-justify mb-5",children:e.body.substring(0,100)}),Object(n.jsxs)("p",{className:"font-italic mb-0",children:["Post\xe9 par ",Object(n.jsx)(i.b,{to:r,style:{color:"#3BA7BF"},children:s})," le"," ",new Date(e.created).toLocaleDateString("fr-FR")]}),Object(n.jsx)(i.b,{to:"/post/".concat(e._id),className:"btn btn-lg btn-block btn-outline-success text-center font-weight-bold mb-3",children:"Lire plus"})]},t)}))})},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){this.loadPosts(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,r=t.posts,s=t.page;return Object(n.jsxs)("div",{className:"jumbotron",children:[Object(n.jsx)("h2",{className:"mt-3 mb-5 text-center",style:{fontWeight:"bold"},children:r.length?"Messages des Pirates de la Taverne des Soiffards":"Rien \xe0 afficher pour le moment..."}),this.renderPosts(r),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col text-right",children:s>1?Object(n.jsx)("button",{className:"btn btn-raised btn-info mt-5 mb-5",onClick:function(){return e.showLessPosts(1)},style:{boxShadow:"3px 3px 5px grey"},children:"Page pr\xe9c\xe9dente"}):""}),Object(n.jsx)("div",{className:"col text-left",children:r.length>s&&r.length===Number("6")?Object(n.jsx)("button",{className:"btn btn-raised btn-info mt-5 mb-5",onClick:function(){return e.showMorePosts(1)},style:{boxShadow:"3px 3px 5px grey"},children:"Page suivante"}):""})]})]})}}]),r}(s.Component),re=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={title:"",body:"",photo:"",error:"",user:{},fileSize:0,loading:!1,redirectionProfile:!1},e.handleChange=function(t){return function(r){var n;e.setState({error:""});var s="photo"===t?r.target.files[0]:r.target.value,a="photo"===t?r.target.files[0].size:0;e.postData.set(t,s),e.setState((n={},Object(L.a)(n,t,s),Object(L.a)(n,"fileSize",a),n))}},e.isValid=function(){var t=e.state,r=t.title,n=t.body;return t.fileSize>1e6?(e.setState({loading:!1,error:"Le poids du fichier ne doit pas d\xe9passer 1Mb ! D\xe9conne pas !"}),!1):0===r.length||r.length>50?(e.setState({loading:!1,error:"Le titre est requis et doit faire moins de 50 caract\xe8res, marin d'eau douce !"}),!1):0!==n.length||(e.setState({loading:!1,error:"Un message est requis pour envoyer un... message, moussaillon."}),!1)},e.postSubmit=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e.setState({loading:!0}),!e.isValid()){t.next=9;break}return n=f().user._id,s=f().token,t.next=7,J(n,s,e.postData);case 7:(a=t.sent).error?e.setState({error:a.error}):e.setState({loading:!1,title:"",body:"",photo:"",redirectionProfile:!0});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postForm=function(t,r){return Object(n.jsxs)("form",{action:"",children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Image"}),Object(n.jsx)("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Titre"}),Object(n.jsx)("input",{onChange:e.handleChange("title"),type:"text",className:"form-control",value:t})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Message"}),Object(n.jsx)("textarea",{onChange:e.handleChange("body"),type:"body",className:"form-control",value:r})]}),Object(n.jsx)("button",{onClick:e.postSubmit,type:"submit",className:"btn btn-raised btn-primary",children:"Envoyer"})]})},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){this.postData=new FormData;try{this.setState({user:f().user})}catch(e){console.error("Something went wrong with componentDidMount method.")}}},{key:"render",value:function(){var e=this.state,t=e.title,r=e.body,s=e.user,a=e.error,o=e.loading;return e.redirectionProfile?Object(n.jsx)(l.a,{to:"/user/".concat(s._id)}):Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("h2",{className:"mt-5 mb-5",children:"Ecrire un message"}),Object(n.jsx)("div",{className:"alert alert-danger",style:{display:a?"":"none"},children:a}),o?Object(n.jsx)("div",{className:"jumbotron text-center",children:Object(n.jsx)("h3",{children:"Chargement..."})}):"",this.postForm(t,r)]})}}]),r}(s.Component),ne=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={message:"",error:""},e.handleChange=function(t){e.setState({error:""}),e.setState({message:t.target.value})},e.isValid=function(){var t=e.state.message;return!(!t.length>0||t.length>300)||(e.setState({error:"Ton commentaire doit \xeatre d'au moins 1 caract\xe8re et d'au plus 300 caract\xe8res, moussaillon !"}),!1)},e.addComment=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a,o,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=f().user._id,s=f().token,a=e.props.postId,o={message:e.state.message},f()){t.next=8;break}return e.setState({error:"Tu dois \xeatre connect\xe9 pour \xe9crire un commentaire, pirate !"}),t.abrupt("return",!1);case 8:if(!e.isValid()){t.next=19;break}return t.prev=9,t.next=12,Q(n,s,a,o);case 12:(c=t.sent).error?console.log("[front-end/src/components/post/WriteComment.jsx => addComment] : response.error: ".concat(JSON.stringify(c.error))):(e.setState({message:""}),e.props.updateComments(c.comments)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(9),console.error("[front-end/src/components/post/WriteComment.jsx => addComment] : error: ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[9,16]])})));return function(e){return t.apply(this,arguments)}}(),e.removeComment=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=f().user._id,s=f().token,a=e.props.postId,t.prev=3,console.log("[front-end/src/components/post/WriteComment.jsx => removeComment] : userId: ".concat(n,", token: ").concat(s,", postId: ").concat(a)),t.next=7,K(n,s,a,r);case 7:(o=t.sent).error?console.log(o.error):e.props.updateComments(o.comments),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("[front-end/src/components/post/WriteComment.jsx => removeComment] : error: ".concat(t.t0));case 14:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}(),e.deleteConfirmation=function(t){window.confirm("Es-tu s\xfbr de vouloir supprimer ton message, pirate ?")&&(console.log("inside deleteConfirmation"),e.removeComment(t))},e}return Object(N.a)(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.comments,a=t.postId,o=this.state,c=o.message,l=o.error;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h2",{className:"mb-5",children:"Donne ton avis sur ce message, moussaillon !"}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsxs)("form",{action:"",onSubmit:this.addComment,children:[Object(n.jsx)("input",{className:"form-control",type:"text",value:c,onChange:this.handleChange,placeholder:"Ecris ici ton avis, bachi-bouzouk..."}),Object(n.jsx)("button",{type:"submit",className:"btn btn-raised btn-success mt-2",children:"Envoyer"})]})}),Object(n.jsx)("div",{className:"alert alert-danger",style:{display:l?"":"none"},children:l}),Object(n.jsxs)("div",{className:"col-md-12",children:[Object(n.jsxs)("h3",{className:"text-success mb-4 mt-4",children:[r.length," ","Commentaire",r.length<=1?"":"s"]}),r.reverse().map((function(t,r){var o,c,l,d,u;"string"===typeof(null===(o=t.author)||void 0===o?void 0:o.pseudo)&&(d=(null===(u=t.author)||void 0===u?void 0:u._id)?"/user/".concat(t.author._id):"");var p=(null===(c=t.author)||void 0===c?void 0:c.pseudo)?t.author.pseudo:"un Inconnu";return Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-md-12",style:{padding:0},children:[Object(n.jsx)(i.b,{to:"/user/".concat(t.author._id),children:Object(n.jsx)("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(_)},src:"".concat("http://localhost:9092/tds","/user/photo/").concat(t.author._id),alt:p})}),Object(n.jsx)("p",{className:"lead",children:t.message})]}),Object(n.jsxs)("p",{className:"font-italic",style:{fontSize:"0.7rem",margin:0},children:["Post\xe9 par"," ",Object(n.jsx)(i.b,{to:"string"===typeof p?d:"/post/".concat(a),style:{color:"#3BA7BF"},children:p})," ","le ",new Date(t.created).toLocaleDateString(),f().user&&f().user._id===(null===(l=t.author)||void 0===l?void 0:l._id)&&Object(n.jsx)(s.Fragment,{children:Object(n.jsx)("button",{className:"btn btn-raised btn-sm btn-danger ml-5",style:{fontSize:"0.9rem",marginBottom:"15px",cursor:"pointer"},onClick:function(){return e.deleteConfirmation(t)},children:"Supprimer"})}),f().user&&"Roi des Pirates"===f().user.right&&Object(n.jsx)(s.Fragment,{children:Object(n.jsx)("button",{className:"btn btn-raised btn-dark font-weight-bold ml-5 btn-sm",style:{fontSize:"0.9rem",marginBottom:"15px",cursor:"pointer"},onClick:function(){return e.deleteConfirmation(t)},children:"Supprimer en tant que Roi"})})]})]}),Object(n.jsx)("hr",{})]},r)}))]})]})}}]),r}(s.Component),se=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={post:"",comments:[],redirectionPosts:!1},e.componentDidMount=Object(p.a)(u.a.mark((function t(){var r,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.match.params.postId,t.next=3,H(r);case 3:(n=t.sent).error?console.log("An error happened when getting the post information."):e.setState({post:n,comments:n.comments});case 5:case"end":return t.stop()}}),t)}))),e.updateComments=function(t){e.setState({comments:t})},e.deleteConfirmation=function(){window.confirm("Es-tu s\xfbr de vouloir supprimer ton message, moussaillon ?")&&e.deletePost()},e.deletePost=Object(p.a)(u.a.mark((function t(){var r,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.props.match.params.postId,n=f().token,t.next=5,Z(r,n);case 5:t.sent.error?console.log("The response couldn't be retrieved from the server. "):e.setState({redirectionPosts:!0}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("The deletePost method encountered the following error: ".concat(t.t0,"."));case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),e.renderPost=function(t){var r,s,a;"string"===typeof t.author&&(a=t.author?"/user/".concat(t.author._id):"");var o=t.author?t.author.pseudo:"un Inconnu";return Object(n.jsxs)("div",{className:"card col-12",style:{backgroundColor:"#D9D9D9"},children:[Object(n.jsx)("div",{className:"card-body text-center",children:Object(n.jsx)("img",{src:"".concat("http://localhost:9092/tds","/post/photo/").concat(t._id,"?").concat((new Date).getTime()),onError:function(e){return e.target.src="".concat(ee)},className:"img-thumbnail mb-3",style:{height:"auto",width:"auto",objectFit:"cover",boxShadow:"3px 3px 10px grey"},alt:t.title})}),Object(n.jsx)("hr",{}),Object(n.jsx)("h2",{className:"mt-3 mb-3 display-2 text-center",children:t.title}),Object(n.jsx)("p",{className:"card-text text-justify lead",style:{padding:"20px"},children:t.body}),Object(n.jsxs)("p",{className:"font-italic",children:["Post\xe9 par"," ",Object(n.jsx)(i.b,{to:"string"===typeof t.author?a:"/post/".concat(t._id),style:{color:"#3BA7BF"},children:o})," ","le ",new Date(t.created).toLocaleDateString("fr-FR")]}),Object(n.jsxs)("div",{className:"inline-block",children:[Object(n.jsx)(i.b,{to:"/posts",className:"btn btn-lg btn-block btn-outline-success text-center font-weight-bold",style:{fontWeight:"bold",fontSize:"1.1rem",marginBottom:"15px"},children:"Retour aux messages"}),f().user&&f().user._id===(null===(r=t.author)||void 0===r?void 0:r._id)&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(i.b,{to:"/post/edit/".concat(t._id),className:"btn btn-raised btn-info mr-3 btn-sm",style:{fontSize:"0.9rem",marginBottom:"15px",cursor:"pointer"},children:"Modifier"}),Object(n.jsx)("button",{className:"btn btn-raised btn-danger",style:{fontSize:"0.9rem",marginBottom:"15px",cursor:"pointer"},onClick:e.deleteConfirmation,children:"Supprimer"})]}),Object(n.jsx)("div",{children:f().user&&"Roi des Pirates"===f().user.right&&Object(n.jsx)("div",{className:"card mt-5 jumbotron",style:{boxShadow:"3px 3px 10px grey",borderRadius:"10%",backgroundColor:"#D9D9D9",padding:"32px"},children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsx)("h5",{className:"card-title mb-3",style:{color:"#9662E3",fontWeight:"bold"},children:"Interface du Roi des Pirates"}),(null===(s=t.author)||void 0===s?void 0:s._id)&&Object(n.jsx)(i.b,{to:"/post/edit/".concat(t._id),className:"btn btn-raised btn-light mr-5 font-weight-bold",style:{color:"black"},children:"Modifier en tant que Roi"}),Object(n.jsx)("button",{onClick:e.deleteConfirmation,className:"btn btn-raised btn-dark font-weight-bold",children:"Supprimer en tant que Roi"})]})})})]})]})},e}return Object(N.a)(r,[{key:"render",value:function(){var e=this.state,t=e.post,r=e.redirectionPosts,s=e.comments;return r?Object(n.jsx)(l.a,{to:"/posts/"}):Object(n.jsxs)("div",{className:"jumbotron",children:[t?this.renderPost(t):Object(n.jsx)("div",{className:"jumbotron text-center",children:Object(n.jsx)("h2",{children:"Chargement..."})}),Object(n.jsx)(ne,{postId:t._id,comments:s,updateComments:this.updateComments})]})}}]),r}(s.Component),ae=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={id:"",title:"",body:"",redirectionProfile:!1,redirectionPosts:!1,error:"",loading:!1,fileSize:0},e.init=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H(r);case 3:(n=t.sent).error?e.setState({redirectionProfile:!0}):e.setState({id:null===(s=n.author)||void 0===s?void 0:s._id,title:n.title,body:n.body,error:""}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("[front-end/src/post/EditPost.jsx => catch:] : error:  ".concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e.isValid=function(){var t=e.state,r=t.title,n=t.body;return t.fileSize>1e6?(e.setState({loading:!1,error:"Le poids du fichier ne doit pas d\xe9passer 1Mb ! D\xe9conne pas !"}),!1):0===r.length||r.length>50?(e.setState({loading:!1,error:"Le titre est requis et doit faire moins de 50 caract\xe8res, marin d'eau douce !"}),!1):0!==n.length||(e.setState({loading:!1,error:"Un message est requis pour envoyer un... message, moussaillon."}),!1)},e.handleChange=function(t){return function(r){var n;e.setState({error:""});var s="photo"===t?r.target.files[0]:r.target.value,a="photo"===t?r.target.files[0].size:0;e.postData.set(t,s),e.setState((n={},Object(L.a)(n,t,s),Object(L.a)(n,"fileSize",a),n))}},e.submitPostUpdate=function(){var t=Object(p.a)(u.a.mark((function t(r){var n,s,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e.setState({loading:!0}),!e.isValid()){t.next=16;break}return n=e.props.match.params.postId,s=f().token,t.prev=5,t.next=8,$(n,s,e.postData);case 8:(a=t.sent).error&&e.setState({error:a.error}),e.setState({loading:!1,title:"",body:"",redirectionProfile:!0}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),console.error("updatePost in EditPost coudldn't retrive data because of error: ".concat(t.t0,"."));case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}(),e.postUpdateForm=function(t,r){return Object(n.jsxs)("form",{action:"",children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Image"}),Object(n.jsx)("input",{onChange:e.handleChange("photo"),type:"file",name:"photo",accept:"image/*",className:"form-control"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Titre"}),Object(n.jsx)("input",{onChange:e.handleChange("title"),type:"text",name:"title",className:"form-control",value:t,autoFocus:!0})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{className:"text-muted",children:"Message"}),Object(n.jsx)("textarea",{onChange:e.handleChange("body"),type:"text",name:"body",className:"form-control",value:r})]}),Object(n.jsx)("button",{onClick:e.submitPostUpdate,className:"btn btn-raised btn-primary",children:"Envoyer"})]})},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){this.postData=new FormData;try{var e=this.props.match.params.postId;e?this.init(e):console.error("No postId found.")}catch(t){console.error("Something went wrong with componentDidMount method.")}}},{key:"render",value:function(){var e,t,r=this.state,s=r.id,a=r.title,o=r.body,c=r.redirectionProfile,i=r.error,d=r.loading,u=this.props.match.params.postId;return c?Object(n.jsx)(l.a,{to:"/post/".concat(u)}):s?Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsx)("div",{className:"alert alert-danger",style:{display:i?"":"none"},children:i}),d?Object(n.jsx)("div",{className:"jumbotron text-center",children:Object(n.jsx)("h2",{children:"Loading..."})}):"",Object(n.jsx)("img",{style:{height:"200px",width:"auto",boxShadow:"3px 3px 10px grey"},className:"img-thumbnail mb-3",src:"".concat("http://localhost:9092/tds","/post/photo/").concat(u,"?").concat((new Date).getTime()),onError:function(e){return e.target.src="".concat(ee)},alt:a}),Object(n.jsx)("h3",{className:"card-title mt-3 mb-3",children:a}),("Roi des Pirates"===f().user.right||(null===(e=f().user)||void 0===e?void 0:e._id)===s)&&this.postUpdateForm(a,o)]})}):Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsx)("div",{className:"alert alert-danger",style:{display:i?"":"none"},children:i}),d?Object(n.jsx)("div",{className:"jumbotron text-center",children:Object(n.jsx)("h2",{children:"Loading..."})}):"",Object(n.jsx)("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail mb-3",src:"".concat("http://localhost:9092/tds","/post/photo/").concat(u,"?").concat((new Date).getTime()),onError:function(e){return e.target.src="".concat(ee)},alt:a}),Object(n.jsx)("h3",{className:"card-title mt-3 mb-3",children:a}),("Roi des Pirates"===f().user.right||(null===(t=f().user)||void 0===t?void 0:t._id)===s)&&this.postUpdateForm(a,o)]})})}}]),r}(s.Component),oe=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={email:"",message:"",error:""},e.handleChange=function(t){return function(r){e.setState({error:""}),e.setState(Object(L.a)({},t,r.target.value))}},e.forgotPassword=function(){var t=Object(p.a)(u.a.mark((function t(r){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),e.setState({message:"",error:""}),t.prev=2,t.next=5,x(e.state.email);case 5:(n=t.sent).error?(console.log("There is an error with the data retrieved in forgotPassword in ForgotPassword: ".concat(n.error,".")),e.setState({error:n.error})):e.setState({message:n.message}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("The method forgotPassword in ForgotPassword encountered an error of type: ".concat(t.t0,"."));case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(N.a)(r,[{key:"render",value:function(){var e=this.state,t=e.email,r=e.message,s=e.error;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h2",{className:"mt-5 mb-5",children:"R\xe9initialisation du mot de passe"}),r&&Object(n.jsx)("h5",{className:"alert alert-info",children:r}),s&&Object(n.jsx)("h5",{className:"alert alert-danger",children:s}),Object(n.jsxs)("form",{children:[Object(n.jsx)("div",{className:"form-group mt-5",children:Object(n.jsx)("input",{type:"email",className:"form-control",placeholder:"L'adresse e-mail li\xe9e \xe0 votre compte sur la Taverne des Soiffards.",value:t,name:"email",onChange:this.handleChange("email"),autoFocus:!0})}),Object(n.jsx)("button",{onClick:this.forgotPassword,className:"btn btn-raised btn-primary",children:"Envoyer le lien de r\xe9initialisation"})]})]})}}]),r}(s.Component),ce=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={newPassword:"",message:"",error:""},e.handleChange=function(t){return function(t){var r=t.target.value;e.setState({newPassword:r,error:"",message:""})}},e.startResetProcess=function(){var t=Object(p.a)(u.a.mark((function t(r){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),e.setState({message:"",error:""}),t.prev=2,console.info("[front-end/src/user/ResetPassword => startResetProcess:21] : newPassword (avant le fetch): ".concat(e.state.newPassword)),console.info("[front-end/src/user/ResetPassword => startResetProcess:24] : this.props.match.params.resetPasswordToken (avant le fetch): ".concat(e.props.match.params.resetPasswordToken)),t.next=7,g({newPassword:e.state.newPassword,resetPasswordLink:e.props.match.params.resetPasswordToken});case 7:(n=t.sent).error?(console.error("[front-end/src/user/ResetPassword => startResetProcess:34] : data.error: ".concat(JSON.stringify(n.error))),e.setState({error:n.error,newPassword:""})):(console.info("[front-end/src/user/ResetPassword => startResetProcess:39] : data.message: ".concat(JSON.stringify(n.message))),e.setState({message:n.message,newPassword:"",redirectionSignIn:!0})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error("Password couldn't be reset because of error: ".concat(t.t0));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(N.a)(r,[{key:"render",value:function(){var e=this.state,t=e.newPassword,r=e.message,s=e.error;return Object(n.jsxs)("div",{className:"container jumbotron",children:[Object(n.jsx)("h2",{className:"mt-5 mb-5",children:"Modification du mot de passe"}),r&&Object(n.jsx)("h5",{className:"alert alert-success",children:r}),s&&Object(n.jsx)("h5",{className:"alert alert-danger",children:s}),Object(n.jsxs)("form",{children:[Object(n.jsx)("div",{className:"form-group mt-5",children:Object(n.jsx)("input",{type:"password",className:"form-control",placeholder:"Choisis ton nouveau mot de passe... et t\xe2che de le noter cette fois-ci, mille sabords !",value:t,name:"newPassword",onChange:this.handleChange("newPassword"),autoFocus:!0})}),Object(n.jsx)("button",{onClick:this.startResetProcess,className:"btn btn-raised btn-primary",children:"Modifier le mot de passe"})]})]})}}]),r}(s.Component),ie=function(e){Object(S.a)(r,e);var t=Object(C.a)(r);function r(){var e;Object(w.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={redirectionHome:!1},e}return Object(N.a)(r,[{key:"componentDidMount",value:function(){"Roi des Pirates"!==f().user.right&&this.setState({redirectionHome:!0})}},{key:"render",value:function(){return this.state.redirectionHome&&l.a,Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"jumbotron",children:[Object(n.jsx)("h2",{className:"text-center",children:"Planque du Roi des Pirates"}),Object(n.jsx)("p",{className:"lead text-justify",children:"Ici, vous avez tous les pouvoirs, mouhahahahaha ! *tousse* Plus s\xe9rieusement, tu es ici dans le panneau d'aministration du site. Si tu es ici, c'est qu'apparemment quelqu'un te pensait digne... Bref, laissons de c\xf4t\xe9 les consid\xe9rations subjectives un instant. Tu peux ici TOUT VOIR, TOUT MODIFIER et TOUT SUPPRIMER ! N'oublie pas, Roi des Pirates, que comme le disait \xe0 juste titre l'oncle Ben dans Spiderman : \"Un grand pouvoir implique de grandes responsabilit\xe9s.\""})]}),Object(n.jsx)("div",{className:"container-fluid jumbotron",children:Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-md-6 text-center",children:[Object(n.jsx)("h2",{children:"Tous les messages des Pirates"}),Object(n.jsx)("hr",{}),Object(n.jsx)(te,{}),Object(n.jsx)("hr",{})]}),Object(n.jsxs)("div",{className:"col-md-6 text-center",children:[Object(n.jsx)("h2",{children:"Tous les Pirates (tes sujets)"}),Object(n.jsx)("hr",{}),Object(n.jsx)(z,{}),Object(n.jsx)("hr",{})]})]})})]})}}]),r}(s.Component),le=r(17),de=r(26),ue=function(e){var t=e.component,r=Object(de.a)(e,["component"]);return Object(n.jsx)(l.b,Object(le.a)(Object(le.a)({},r),{},{render:function(e){return f()?Object(n.jsx)(t,Object(le.a)({},e)):Object(n.jsx)(l.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))},pe=function(){return Object(n.jsxs)(i.a,{children:[Object(n.jsx)(O,{}),Object(n.jsxs)(l.d,{children:[Object(n.jsx)(l.b,{exact:!0,path:"/",component:I}),Object(n.jsx)(ue,{exact:!0,path:"/admin",component:ie}),Object(n.jsx)(l.b,{exact:!0,path:"/forgot-password",component:oe}),Object(n.jsx)(l.b,{exact:!0,path:"/reset-password/:resetPasswordToken",component:ce}),Object(n.jsx)(l.b,{exact:!0,path:"/users",component:z}),Object(n.jsx)(ue,{exact:!0,path:"/posts",component:te}),Object(n.jsx)(ue,{exact:!0,path:"/post/create",component:re}),Object(n.jsx)(ue,{exact:!0,path:"/post/:postId",component:se}),Object(n.jsx)(ue,{exact:!0,path:"/post/edit/:postId",component:ae}),Object(n.jsx)(l.b,{exact:!0,path:"/signup",component:W}),Object(n.jsx)(l.b,{exact:!0,path:"/signin",component:q}),Object(n.jsx)(ue,{exact:!0,path:"/user/edit/:userId",component:Y}),Object(n.jsx)(ue,{exact:!0,path:"/user/:userId",component:X})]})]})};c.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(pe,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.27f2e799.chunk.js.map